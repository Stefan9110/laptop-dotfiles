#!/bin/bash

# Check project name
if [ $# -eq 0 ] || [ -z $1 ]; then
	echo "Project name?"
	exit 1
fi

LANG="cpp"

# Select language if present
if [ $# -eq 2 ] || [ ! -z $2 ]; then
	echo $2 | grep -Eoq "c(pp)?" && LANG=$2
fi

PROJ_PATH="$HOME/Coding/C/$1"

# Check if project already exists in order to not ovveride existing files
if [ -d $PROJ_PATH ]; then
	echo "Project already exists..."	
	vim "$PROJ_PATH/$(ls $PROJ_PATH | grep -Eo "$1\.c(pp)?")"
	exit 1;
fi

# Create project files
mkdir -p $PROJ_PATH
touch "$PROJ_PATH/$1.in" "$PROJ_PATH/$1.out"

# Create main C/C++ file
case $LANG in
	"cpp")
		echo "// Project generated by Stefan911 at $(date)
#include <bits/stdc++.h>

std::ifstream in(\"$1.in\");
std::ofstream out(\"$1.out\");

int main() {

	return 0;
}
" > "$PROJ_PATH/$1.cpp"
		;;
	"c")
		echo "// Project generated by Stefan911 at $(date)
#include <stdio.h> 

int main() {

	return 0;
}
" > "$PROJ_PATH/$1.c"
		;;
esac

# Enter vim
vim "$PROJ_PATH/$1.$LANG"
